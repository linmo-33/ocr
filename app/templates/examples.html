<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½¿ç”¨ç¤ºä¾‹ - éªŒè¯ç è¯†åˆ«ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .example-section {
            margin-bottom: 40px;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }
        .code-block .comment {
            color: #6a9955;
        }
        .code-block .string {
            color: #ce9178;
        }
        .code-block .keyword {
            color: #569cd6;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
        }
        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="back-link">â† è¿”å›ä¸»é¡µ</a>
        
        <div class="header">
            <h1>ğŸ“š ä½¿ç”¨ç¤ºä¾‹</h1>
            <p>å„ç§éªŒè¯ç è¯†åˆ«çš„ä»£ç ç¤ºä¾‹</p>
        </div>

        <div class="card">
            <div class="example-section">
                <h2>1. OCRæ–‡å­—è¯†åˆ«</h2>
                <h3>Python ç¤ºä¾‹</h3>
                <div class="code-block">
<span class="keyword">import</span> requests
<span class="keyword">import</span> base64

<span class="comment"># è¯»å–å›¾ç‰‡å¹¶è½¬æ¢ä¸ºBase64</span>
<span class="keyword">with</span> open(<span class="string">'captcha.png'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:
    image_base64 = base64.b64encode(f.read()).decode()

<span class="comment"># å‘é€è¯†åˆ«è¯·æ±‚</span>
response = requests.post(
    <span class="string">'http://localhost:7777/classification'</span>,
    json={
        <span class="string">'image'</span>: image_base64,
        <span class="string">'preprocess'</span>: <span class="keyword">True</span>
    }
)

result = response.json()
print(<span class="string">f"è¯†åˆ«ç»“æœ: {result['result']['text']}"</span>)
print(<span class="string">f"ç½®ä¿¡åº¦: {result['result']['confidence']}"</span>)
                </div>

                <h3>JavaScript ç¤ºä¾‹</h3>
                <div class="code-block">
<span class="keyword">async function</span> recognizeText(imageBase64) {
    <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(<span class="string">'http://localhost:7777/classification'</span>, {
        method: <span class="string">'POST'</span>,
        headers: {
            <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>
        },
        body: JSON.stringify({
            image: imageBase64,
            preprocess: <span class="keyword">true</span>
        })
    });
    
    <span class="keyword">const</span> result = <span class="keyword">await</span> response.json();
    console.log(<span class="string">'è¯†åˆ«ç»“æœ:'</span>, result.result.text);
    <span class="keyword">return</span> result;
}
                </div>

                <h3>cURL ç¤ºä¾‹</h3>
                <div class="code-block">
curl -X POST http://localhost:7777/classification \
  -H <span class="string">"Content-Type: application/json"</span> \
  -d <span class="string">'{
    "image": "iVBORw0KGgoAAAANSUhEUgAA...",
    "preprocess": true
  }'</span>
                </div>
            </div>

            <div class="example-section">
                <h2>2. æ»‘å—éªŒè¯ç è¯†åˆ«</h2>
                <h3>Python ç¤ºä¾‹</h3>
                <div class="code-block">
<span class="keyword">import</span> requests
<span class="keyword">import</span> base64

<span class="comment"># è¯»å–æ»‘å—å’ŒèƒŒæ™¯å›¾ç‰‡</span>
<span class="keyword">with</span> open(<span class="string">'slider.png'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:
    slider_base64 = base64.b64encode(f.read()).decode()

<span class="keyword">with</span> open(<span class="string">'background.png'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:
    bg_base64 = base64.b64encode(f.read()).decode()

<span class="comment"># å‘é€è¯†åˆ«è¯·æ±‚</span>
response = requests.post(
    <span class="string">'http://localhost:7777/capcode'</span>,
    json={
        <span class="string">'slidingImage'</span>: slider_base64,
        <span class="string">'backImage'</span>: bg_base64,
        <span class="string">'simpleTarget'</span>: <span class="keyword">True</span>,
        <span class="string">'preprocess'</span>: <span class="keyword">False</span>
    }
)

result = response.json()
print(<span class="string">f"æ»‘å—ä½ç½®: {result['result']['position']}px"</span>)
                </div>
            </div>

            <div class="example-section">
                <h2>3. æ‰¹é‡è¯†åˆ«</h2>
                <h3>Python ç¤ºä¾‹</h3>
                <div class="code-block">
<span class="keyword">import</span> requests
<span class="keyword">import</span> base64
<span class="keyword">import</span> os

<span class="comment"># æ‰¹é‡è¯»å–å›¾ç‰‡</span>
images = []
<span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(<span class="string">'captchas'</span>):
    <span class="keyword">with</span> open(os.path.join(<span class="string">'captchas'</span>, filename), <span class="string">'rb'</span>) <span class="keyword">as</span> f:
        images.append(base64.b64encode(f.read()).decode())

<span class="comment"># æ‰¹é‡è¯†åˆ«ï¼ˆæœ€å¤š20å¼ ï¼‰</span>
response = requests.post(
    <span class="string">'http://localhost:7777/batch/classification'</span>,
    json={
        <span class="string">'images'</span>: images[:20],
        <span class="string">'preprocess'</span>: <span class="keyword">True</span>
    }
)

results = response.json()
<span class="keyword">for</span> item <span class="keyword">in</span> results[<span class="string">'results'</span>]:
    print(<span class="string">f"å›¾ç‰‡ {item['index']}: {item['result']['text']}"</span>)
                </div>
            </div>

            <div class="example-section">
                <h2>4. è®¡ç®—ç±»éªŒè¯ç </h2>
                <h3>Python ç¤ºä¾‹</h3>
                <div class="code-block">
<span class="keyword">import</span> requests
<span class="keyword">import</span> base64

<span class="keyword">with</span> open(<span class="string">'math_captcha.png'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:
    image_base64 = base64.b64encode(f.read()).decode()

response = requests.post(
    <span class="string">'http://localhost:7777/calculate'</span>,
    json={<span class="string">'image'</span>: image_base64}
)

result = response.json()
print(<span class="string">f"è®¡ç®—ç»“æœ: {result['result']}"</span>)
                </div>
            </div>

            <div class="example-section">
                <h2>5. ä½¿ç”¨å›¾ç‰‡URL</h2>
                <h3>Python ç¤ºä¾‹</h3>
                <div class="code-block">
<span class="keyword">import</span> requests

<span class="comment"># ç›´æ¥ä½¿ç”¨å›¾ç‰‡URL</span>
response = requests.post(
    <span class="string">'http://localhost:7777/classification'</span>,
    json={
        <span class="string">'image'</span>: <span class="string">'https://example.com/captcha.png'</span>,
        <span class="string">'preprocess'</span>: <span class="keyword">False</span>
    }
)

result = response.json()
print(result)
                </div>
            </div>

            <div class="example-section">
                <h2>6. æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯</h2>
                <h3>Python ç¤ºä¾‹</h3>
                <div class="code-block">
<span class="keyword">import</span> requests

<span class="comment"># è·å–APIç»Ÿè®¡</span>
response = requests.get(<span class="string">'http://localhost:7777/stats'</span>)
stats = response.json()

print(<span class="string">f"æ€»è¯·æ±‚æ•°: {stats['total_requests']}"</span>)
print(<span class="string">f"æˆåŠŸç‡: {stats['success_rate']}"</span>)
print(<span class="string">f"å¹³å‡å“åº”æ—¶é—´: {stats['average_processing_time']}"</span>)

<span class="comment"># æŸ¥çœ‹å„ç«¯ç‚¹ç»Ÿè®¡</span>
<span class="keyword">for</span> endpoint, data <span class="keyword">in</span> stats[<span class="string">'endpoints'</span>].items():
    print(<span class="string">f"\n{endpoint}:"</span>)
    print(<span class="string">f"  è°ƒç”¨æ¬¡æ•°: {data['count']}"</span>)
    print(<span class="string">f"  æˆåŠŸ: {data['success']}"</span>)
    print(<span class="string">f"  å¤±è´¥: {data['failed']}"</span>)
    print(<span class="string">f"  å¹³å‡è€—æ—¶: {data['avg_time']:.3f}s"</span>)
                </div>
            </div>

            <div class="example-section">
                <h2>7. é”™è¯¯å¤„ç†</h2>
                <h3>Python ç¤ºä¾‹</h3>
                <div class="code-block">
<span class="keyword">import</span> requests

<span class="keyword">try</span>:
    response = requests.post(
        <span class="string">'http://localhost:7777/classification'</span>,
        json={<span class="string">'image'</span>: image_base64},
        timeout=30
    )
    
    <span class="keyword">if</span> response.status_code == 200:
        result = response.json()
        print(<span class="string">f"æˆåŠŸ: {result['result']['text']}"</span>)
    <span class="keyword">elif</span> response.status_code == 429:
        print(<span class="string">"è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•"</span>)
    <span class="keyword">else</span>:
        error = response.json()
        print(<span class="string">f"é”™è¯¯: {error.get('error', 'æœªçŸ¥é”™è¯¯')}"</span>)
        
<span class="keyword">except</span> requests.exceptions.Timeout:
    print(<span class="string">"è¯·æ±‚è¶…æ—¶"</span>)
<span class="keyword">except</span> requests.exceptions.ConnectionError:
    print(<span class="string">"è¿æ¥å¤±è´¥"</span>)
<span class="keyword">except</span> Exception <span class="keyword">as</span> e:
    print(<span class="string">f"å‘ç”Ÿé”™è¯¯: {e}"</span>)
                </div>
            </div>
        </div>

        <div class="footer">
            <p>
                <a href="/">â† è¿”å›ä¸»é¡µ</a> | 
                <a href="/docs" target="_blank">ğŸ“– APIæ–‡æ¡£</a>
            </p>
        </div>
    </div>
</body>
</html>
